# 🗺️ 道路ネットワーク抽出ツール

地図画像から道路ネットワークを自動抽出し、Scratch用のCSVデータを生成するWebアプリケーションです。

## 🚀 デモ

Streamlit Cloudでデプロイ: [ここにURLを追加]

## ✨ 機能

- 📸 地図画像のアップロード（PNG, JPG）
- 🔍 自動ノード検出（端点、交差点、曲がり角）
- 🛣️ 道路接続の自動解析
- 📊 Scratch座標系への変換
- 📥 CSV形式でのエクスポート
- 🎨 検出結果の可視化

## 🎯 検出されるノードタイプ

- **端点** (青): 道路の終端
- **交差点** (緑): 3本以上の道が交わる点
- **曲がり角** (オレンジ): 道路が急に曲がる点

## 🛠️ ローカル実行

### 必要なもの

- Python 3.8以上

### インストール

```bash
# リポジトリをクローン
git clone https://github.com/yourusername/road-network-extractor.git
cd road-network-extractor

# 依存関係をインストール
pip install -r requirements.txt
```

### 実行

```bash
streamlit run app.py
```

ブラウザで `http://localhost:8501` を開きます。

## 📦 出力ファイル

### nodes.csv
```csv
id,x,y,type
1,-180.5,120.3,corner
2,-45.2,80.1,junction
3,120.8,-50.4,endpoint
```

### edges.csv
```csv
source_id,target_id
1,2
2,1
2,3
3,2
```

## ⚙️ パラメータ調整

アプリのサイドバーで以下のパラメータを調整できます：

- **曲がり角の検出角度**: 曲がり角と判定する角度の閾値
- **ノード統合半径**: 近接ノードを統合する距離
- **エッジ最大距離**: ノード間を接続する最大距離
- **角度許容範囲**: 同じノードから出る道路の最小角度差
- **白領域判定閾値**: 障害物として扱う明度の閾値

## 📝 使用例

1. 地理院地図などから道路地図をキャプチャ
2. アプリに画像をアップロード
3. パラメータを調整（必要に応じて）
4. 「処理を開始」をクリック
5. CSVファイルをダウンロード
6. ScratchやPythonで道路ネットワークを活用

## 🔧 技術スタック

- **Streamlit**: Webアプリフレームワーク
- **OpenCV**: 画像処理
- **NumPy**: 数値計算

## 📄 ライセンス

MIT License

## 🤝 貢献

プルリクエストを歓迎します！

## 📧 お問い合わせ

質問や提案があれば、Issueを作成してください。

---

Made with ❤️ using Streamlit
